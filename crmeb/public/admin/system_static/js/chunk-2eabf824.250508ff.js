(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2eabf824"],{"179b":function(e,t,i){"use strict";var a=i("74b4");i.n(a).a},"46c4":function(e,t,i){"use strict";i.d(t,"e",(function(){return n})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"h",(function(){return r})),i.d(t,"f",(function(){return d})),i.d(t,"d",(function(){return u})),i.d(t,"g",(function(){return c})),i.d(t,"i",(function(){return m}));var a=i("6b6c");function n(e){return Object(a.a)({url:"/setting/menus",method:"get",params:e})}function l(e){return Object(a.a)({url:"/setting/menus/unique",method:"get",params:e})}function s(){return Object(a.a)({url:"/setting/menus/create",method:"get"})}function o(e){return Object(a.a)({url:e.url,method:e.method,data:e.datas})}function r(e){return Object(a.a)({url:"/setting/menus/".concat(e),method:"get"})}function d(e){return Object(a.a)({url:"/setting/menus/show/".concat(e.id),method:"put",data:e})}function u(e){return Object(a.a)({url:"/setting/ruleList?cate_id=".concat(e),method:"get"})}function c(e){return Object(a.a)({url:"setting/menus/batch",method:"post",data:e})}function m(e){return Object(a.a)({url:"setting/rule_cate",method:"get"})}},"4bb7":function(e,t,i){"use strict";var a=i("a772");i.n(a).a},5003:function(e,t,i){},"74b4":function(e,t,i){},"7b98":function(e,t,i){"use strict";var a=i("ec36");i.n(a).a},a772:function(e,t,i){},a9e7:function(e,t,i){"use strict";i.d(t,"f",(function(){return n})),i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return d})),i.d(t,"g",(function(){return u}));var a=i("6b6c");function n(){return Object(a.a)({url:"/system/crud/menus",method:"get"})}function l(){return Object(a.a)({url:"/system/crud/column_type",method:"get"})}function s(e){return Object(a.a)({url:"/system/crud/file_path",method:"post",data:e})}function o(e){return Object(a.a)({url:"/system/crud",method:"get",params:e})}function r(e){return Object(a.a)({url:"/system/crud/".concat(e),method:"get"})}function d(e){return Object(a.a)({url:"/system/crud/download/".concat(e),method:"get"})}function u(e,t){return Object(a.a)({url:"/system/crud/save_file/".concat(e),method:"post",data:t})}},b21d:function(e,t,i){"use strict";i.r(t);var a=i("f3f3"),n=(i("a9e3"),i("d81d"),i("d3b7"),i("159b"),i("b0c0"),i("90e7")),l=(i("caad"),i("a434"),i("a9e7")),s={name:"",props:{foundation:{type:Object,default:function(){return{}}}},data:function(){return{foundationRules:{tableName:[{required:!0,message:"请输入表名",trigger:"blur"}],modelName:[{required:!0,message:"请输入模块名",trigger:"blur"}]},menusList:[],columnTypeList:[],columns:[{title:"字段名称",slot:"field",minWidth:100},{title:"字段类型",slot:"field_type",minWidth:100},{title:"长度",slot:"limit",minWidth:100},{title:"默认值",slot:"default",minWidth:100},{title:"字段描述",slot:"comment",minWidth:100},{title:"列表",slot:"is_table",width:70,align:"center"},{title:"列表名",slot:"table_name",minWidth:120,align:"center"},{title:"表单类型",slot:"from_type",minWidth:100},{title:"必填",slot:"required",width:70,align:"center"},{title:"操作",slot:"action",width:70,align:"center"}],fromTypeList:[{value:"0",label:"不生成"},{value:"input",label:"input"},{value:"textarea",label:"textarea"},{value:"radio",label:"radio"},{value:"number",label:"number"},{value:"frameImageOne",label:"frameImageOne"},{value:"frameImages",label:"frameImages"}],loading:!1,tableField:[]}},created:function(){this.getCrudMenus()},mounted:function(){},methods:{disabledInput:function(e){var t=this.tableField[e];e=["addTimestamps","addSoftDelete"].includes(this.tableField[e].field_type);return t.primaryKey&&(e=!0),"delete_time"===t.field&&"timestamp"===t.field_type||e},initfield:function(){this.tableField=[]},changeItemField:function(e,t){"addSoftDelete"===e&&this.$set(this.tableField[t],"comment","伪删除"),"addTimestamps"===e&&this.$set(this.tableField[t],"comment","添加和修改时间")},getCrudMenus:function(){var e=this;Object(l.f)().then((function(t){e.menusList=t.data})),Object(l.a)().then((function(t){e.columnTypeList=t.data.types}))},del:function(e){this.tableField.splice(e,1)}}},o=(i("179b"),i("2877")),r=(s=Object(o.a)(s,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("div",{staticClass:"main"},[t("Alert",{attrs:{closable:""}},[e._v(" crud生成说明 不能生成系统自带的表；已经生成过的表还能继续生成 ")]),t("Form",{ref:"foundation",attrs:{model:e.foundation,rules:e.foundationRules,"label-width":100}},[t("FormItem",{attrs:{label:"菜单"}},[t("el-cascader",{staticClass:"form-width",attrs:{size:"small",options:e.menusList,props:{checkStrictly:!0,multiple:!1,emitPath:!1},clearable:""},model:{value:e.foundation.pid,callback:function(t){e.$set(e.foundation,"pid",t)},expression:"foundation.pid"}}),t("div",{staticClass:"tip"},[e._v("选项，选择的菜单成功后会自动写入到此菜单下")])],1),t("FormItem",{attrs:{label:"菜单名称"}},[t("Input",{staticClass:"form-width",attrs:{placeholder:"请输入菜单名称"},model:{value:e.foundation.menuName,callback:function(t){e.$set(e.foundation,"menuName",t)},expression:"foundation.menuName"}}),t("div",{staticClass:"tip"},[e._v("\n        生成菜单为可选项，不填写默认生成的菜单名称将为表名；生成后会把自动生成的权限默认加入该菜单下\n      ")])],1),t("FormItem",{attrs:{label:"模块名",prop:"modelName"}},[t("Input",{staticClass:"form-width",attrs:{placeholder:"请输入模块名"},model:{value:e.foundation.modelName,callback:function(t){e.$set(e.foundation,"modelName",t)},expression:"foundation.modelName"}}),t("div",{staticClass:"tip"},[e._v("模块名称为中文或者英文，用在接口名称前缀、表单头部标题")])],1),t("FormItem",{attrs:{label:"表名",prop:"tableName"}},[t("Input",{staticClass:"form-width",attrs:{placeholder:"请输入表名"},model:{value:e.foundation.tableName,callback:function(t){e.$set(e.foundation,"tableName",t)},expression:"foundation.tableName"}}),t("div",{staticClass:"tip"},[e._v("\n        用于生成CRUD指定的表名，不需要携带表前缀；对于生成过的表将不能在进行生成；或者可以删除对应的文件重新生成！对应系统中重要的数据表将不允许生成！\n      ")])],1)],1)],1)}),[],!1,null,"4ae57285",null).exports,i("d0ff")),d=(i("c740"),i("99af"),{name:"",props:{foundation:{type:Object,default:function(){return{}}},id:{type:String|Number}},data:function(){return{foundationRules:{},menusList:[],columnTypeList:[],optionsModal:!1,isCreate:!1,isDelete:!1,columns:[{title:"字段名称",slot:"field",minWidth:100},{title:"字段类型",slot:"field_type",minWidth:100},{title:"长度",slot:"limit",minWidth:100},{title:"默认值",slot:"default",minWidth:100},{title:"字段描述",slot:"comment",minWidth:100},{title:"列表",slot:"is_table",width:70,align:"center"},{title:"列表名",slot:"table_name",minWidth:120,align:"center"},{title:"表单类型",slot:"from_type",minWidth:100},{title:"字典配置",slot:"options",minWidth:100},{title:"必填",slot:"required",width:70,align:"center"},{title:"操作",slot:"action",width:70,align:"center"}],fromTypeList:[],loading:!1,tableField:[],optionsList:[],index:0,deleteField:[]}},created:function(){this.getCrudMenus()},mounted:function(){},methods:{disabledInput:function(e){var t=this.tableField[e];e=["addTimestamps","addSoftDelete"].includes(this.tableField[e].field_type);return!!(t.primaryKey||"delete_time"===t.field&&"timestamp"===t.field_type||("create_time"===t.field||"update_time"===t.field)&&"timestamp"===t.field_type)||e},initfield:function(){this.tableField=[]},changeItemField:function(e,t){"addSoftDelete"===e&&this.$set(this.tableField[t],"comment","伪删除"),"addTimestamps"===e&&this.$set(this.tableField[t],"comment","添加和修改时间")},eidtOptions:function(e){this.index=e,this.optionsList=this.tableField[e].options||[{label:"",value:""}],this.optionsModal=!0},addOptions:function(){this.$set(this.tableField[this.index],"options",this.optionsList)},changeRadio:function(e){this.tableField=[],e&&this.addRow()},initTableName:function(){this.tableField=[]},addRow:function(){for(var e=0;e<this.tableField.length;e++){var t=this.tableField[e];if(!(t.field&&t.field_type||["addTimestamps","addSoftDelete"].includes(t.field_type)))return this.$Message.warning("请先完善上一条数据");if(t.is_table&&!t.table_name&&!Number(t.primaryKey)&&!["addTimestamps","addSoftDelete"].includes(t.field_type))return this.$Message.warning("请输入列表名")}this.tableField.length;var i,a=0;this.tableField.map((function(e){"create_time"!==e.field&&"update_time"!==e.field||a++,"delete_time"===e.field&&a++})),i=this.tableField.length-a,this.tableField.splice(i,0,{field:"",field_type:"",default:"",comment:"",required:!1,is_table:!0,table_name:"",limit:"",primaryKey:0,from_type:"0"})},addCreate:function(e){var t=this;if(e){e=this.tableField.findIndex((function(e){return"create_time"===e.field}));var i=this.tableField.findIndex((function(e){return"update_time"===e.field}));if(0<e||0<i)return this.$nextTick((function(e){t.isCreate=!1})),this.$Message.warning("已存在 create_time或update_time");this.tableField=[].concat(Object(r.a)(this.tableField),[{field:"create_time",field_type:"timestamp",default:"",comment:"添加时间",required:!1,is_table:!0,table_name:"添加时间",limit:"",primaryKey:0,from_type:"0"},{field:"update_time",field_type:"timestamp",default:"",comment:"修改时间",required:!1,is_table:!0,table_name:"修改时间",limit:"",primaryKey:0,from_type:"0"}])}else e=this.tableField.findIndex((function(e){return"create_time"===e.field})),this.tableField.splice(e,2)},addDelete:function(e){if(e){if(0<this.tableField.findIndex((function(e){return"delete_time"===e.field})))return this.isDelete=!1,this.$Message.warning("已存在 delete_time");this.tableField=[].concat(Object(r.a)(this.tableField),[{field:"delete_time",field_type:"timestamp",default:"",comment:"伪删除",required:!1,is_table:!1,table_name:"伪删除",limit:"",primaryKey:0,from_type:"0"}])}else e=this.tableField.findIndex((function(e){return"delete_time"===e.field})),this.tableField.splice(e,1)},changeField:function(e){if(this.tableField[e].field)for(var t=0;t<this.tableField.length;t++)if(this.tableField[t],["id","create_time","update_time","delete_time"].includes(this.tableField[e].field))return this.$Message.warning("列表中已存在该字段名称"),void(this.tableField[e].field="")},changeComment:function(e,t){this.tableField[t].table_name=e.target.value},getCrudMenus:function(){var e=this;Object(l.f)().then((function(t){e.menusList=t.data})),Object(l.a)().then((function(t){e.columnTypeList=t.data.types,e.fromTypeList=t.data.form}))},del:function(e,t){this.tableField.splice(t,1),this.id&&this.deleteField.push(e.field)},addOneOptions:function(){this.optionsList.push({label:"",value:""})},delOneOptions:function(e){this.optionsList.splice(e,1)}}}),u=(d=(i("4bb7"),Object(o.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("Alert",{attrs:{closable:""},scopedSlots:e._u([{key:"desc",fn:function(){return[i("p",[e._v("\n        1、字段配置中表存在生成的字段为表内列的信息,并且主键、伪删除字段不允许设置为列，主键默认展示在列表中，伪删除字段不允许展示\n      ")]),i("p",[e._v("2、在字段配置中新建表时，主键不需要增加列，会自动增加一行主键id")]),i("p",[e._v("\n        3、在字段配置中新建表时，字段类型为addTimestamps会自动创建create_time、update_time字段，字段类型为：timestamp\n      ")]),i("p",[e._v("\n        4、在字段配置中新建表时，字段类型为addSoftDelete会字段创建delete_time字段，字段类型为：timestamp，作用是伪删除\n      ")]),i("p",[e._v("5、在字段配置中，表单类型为不生成时创建后不会生成对应的表单项")]),i("p",[e._v("6、添加字段id、create_time、update_time、delete_time为不可用字段")])]},proxy:!0}])},[e._v("\n    crud生成说明\n    ")]),i("div",{staticClass:"df"},[i("Button",{staticClass:"mr20",attrs:{type:"primary"},on:{click:e.addRow}},[e._v("添加一行")]),i("Checkbox",{staticClass:"mr10",on:{"on-change":e.addCreate},model:{value:e.isCreate,callback:function(t){e.isCreate=t},expression:"isCreate"}},[e._v("添加与修改时间")]),i("Checkbox",{staticClass:"mr10",on:{"on-change":e.addDelete},model:{value:e.isDelete,callback:function(t){e.isDelete=t},expression:"isDelete"}},[e._v("伪删除")])],1),i("div",[i("Table",{ref:"selection",attrs:{columns:e.columns,data:e.tableField,"no-data-text":"暂无数据","highlight-row":"",loading:e.loading,"max-height":"600",size:"small","no-filtered-data-text":"暂无筛选结果"},scopedSlots:e._u([{key:"field",fn:function(t){t.row;var a=t.index;return[i("Input",{attrs:{disabled:e.disabledInput(a)},on:{"on-blur":function(t){return e.changeField(a)}},model:{value:e.tableField[a].field,callback:function(t){e.$set(e.tableField[a],"field",t)},expression:"tableField[index].field"}})]}},{key:"field_type",fn:function(t){t.row;var a=t.index;return[i("Select",{attrs:{disabled:e.disabledInput(a)},on:{"on-change":function(t){return e.changeItemField(t,a)}},model:{value:e.tableField[a].field_type,callback:function(t){e.$set(e.tableField[a],"field_type",t)},expression:"tableField[index].field_type"}},e._l(e.columnTypeList,(function(t){return i("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)]}},{key:"limit",fn:function(t){t.row;var a=t.index;return[i("Input",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].limit,callback:function(t){e.$set(e.tableField[a],"limit",t)},expression:"tableField[index].limit"}})]}},{key:"default",fn:function(t){t.row;var a=t.index;return[i("Input",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].default,callback:function(t){e.$set(e.tableField[a],"default",t)},expression:"tableField[index].default"}})]}},{key:"comment",fn:function(t){t.row;var a=t.index;return[i("Input",{attrs:{disabled:e.disabledInput(a)},on:{"on-change":function(t){return e.changeComment(t,a)}},model:{value:e.tableField[a].comment,callback:function(t){e.$set(e.tableField[a],"comment",t)},expression:"tableField[index].comment"}})]}},{key:"required",fn:function(t){t.row;var a=t.index;return[i("Checkbox",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].required,callback:function(t){e.$set(e.tableField[a],"required",t)},expression:"tableField[index].required"}})]}},{key:"is_table",fn:function(t){t.row;var a=t.index;return[i("Checkbox",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].is_table,callback:function(t){e.$set(e.tableField[a],"is_table",t)},expression:"tableField[index].is_table"}})]}},{key:"table_name",fn:function(t){t.row;var a=t.index;return[i("Input",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].table_name,callback:function(t){e.$set(e.tableField[a],"table_name",t)},expression:"tableField[index].table_name"}})]}},{key:"from_type",fn:function(t){t.row;var a=t.index;return[i("Select",{attrs:{disabled:e.disabledInput(a)},model:{value:e.tableField[a].from_type,callback:function(t){e.$set(e.tableField[a],"from_type",t)},expression:"tableField[index].from_type"}},e._l(e.fromTypeList,(function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)]}},{key:"options",fn:function(t){t.row;var a=t.index;return[["select","radio","checkbox"].includes(e.tableField[a].from_type)?i("div",{staticClass:"table-options"},[i("Select",e._l(e.tableField[a].options,(function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1),i("Icon",{staticClass:"create",attrs:{type:"md-create"},on:{click:function(t){return e.eidtOptions(a)}}})],1):i("div",[e._v("--")])]}},{key:"action",fn:function(t){var a=t.row,n=t.index;return[e.tableField[n].primaryKey||e.disabledInput(n)?i("span",[e._v("--")]):i("a",{on:{click:function(t){return e.del(a,n)}}},[e._v("删除")])]}}])})],1),i("Modal",{attrs:{scrollable:"",title:"字典配置",closable:"","mask-closable":!1,width:"400px"},on:{"on-ok":e.addOptions,"on-cancel":function(t){e.optionsModal=!1}},model:{value:e.optionsModal,callback:function(t){e.optionsModal=t},expression:"optionsModal"}},[i("div",{staticClass:"options-list"},e._l(e.optionsList,(function(t,a){return i("div",{key:a,staticClass:"item"},[i("Input",{staticClass:"mr10",staticStyle:{width:"150px"},attrs:{placeholder:"label"},model:{value:t.label,callback:function(i){e.$set(t,"label",i)},expression:"item.label"}}),i("Input",{staticClass:"mr10",staticStyle:{width:"150px"},attrs:{placeholder:"value"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}}),a==e.optionsList.length-1?i("Icon",{staticClass:"add",attrs:{type:"md-add-circle"},on:{click:e.addOneOptions}}):e._e(),0<a?i("Icon",{staticClass:"add",attrs:{type:"md-remove-circle"},on:{click:function(t){return e.delOneOptions(a)}}}):e._e()],1)})),0)])],1)}),[],!1,null,"4e63305c",null).exports),{name:"",props:{storage:{type:Object,default:function(){return{}}}},data:function(){return{storageRules:{}}},created:function(){},mounted:function(){},methods:{}}),c=(u=(i("7b98"),Object(o.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("Alert",{attrs:{closable:""},scopedSlots:e._u([{key:"desc",fn:function(){return[i("p",[e._v("1、生成的文件位置尽量不要修改，可以在创建后自行移动")]),i("p",[e._v("2、生成的文件位置不会包含文件的绝对路径，在创建时会携带提前预设的绝对路径")]),i("p",[e._v("3、前端模板文件默认位置在：config/app.php的admin_template_path中配置")]),i("p",[e._v("4、后端默认生成位置为：网站根目录")]),i("p",[e._v("5、确保前端/admin/src目录、后端app目录有写入创建文件权限")])]},proxy:!0}])},[e._v("\n    crud生成文件位置说明\n    ")]),i("Form",{ref:"foundation",attrs:{model:e.storage,rules:e.storageRules,"label-width":130}},[i("FormItem",{attrs:{label:"生成controller位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.controller,callback:function(t){e.$set(e.storage,"controller",t)},expression:"storage.controller"}}),i("div",{staticClass:"tip"},[e._v("生成后端控制器文件存放位置")])],1),i("FormItem",{attrs:{label:"生成service位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.service,callback:function(t){e.$set(e.storage,"service",t)},expression:"storage.service"}}),i("div",{staticClass:"tip"},[e._v("生成后端service文件存放位置")])],1),i("FormItem",{attrs:{label:"生成dao位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.dao,callback:function(t){e.$set(e.storage,"dao",t)},expression:"storage.dao"}}),i("div",{staticClass:"tip"},[e._v("生成后端dao文件存放位置")])],1),i("FormItem",{attrs:{label:"生成model位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.model,callback:function(t){e.$set(e.storage,"model",t)},expression:"storage.model"}}),i("div",{staticClass:"tip"},[e._v("生成后端model文件存放位置")])],1),i("FormItem",{attrs:{label:"生成route位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.route,callback:function(t){e.$set(e.storage,"route",t)},expression:"storage.route"}}),i("div",{staticClass:"tip"},[e._v("生成后端路由存放位置")])],1),i("FormItem",{attrs:{label:"生成validate位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.validate,callback:function(t){e.$set(e.storage,"validate",t)},expression:"storage.validate"}}),i("div",{staticClass:"tip"},[e._v("生成后端验证器存放位置")])],1),i("FormItem",{attrs:{label:"生成pages位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.pages,callback:function(t){e.$set(e.storage,"pages",t)},expression:"storage.pages"}}),i("div",{staticClass:"tip"},[e._v("生成前端页面文件存放位置")])],1),i("FormItem",{attrs:{label:"生成api位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.api,callback:function(t){e.$set(e.storage,"api",t)},expression:"storage.api"}}),i("div",{staticClass:"tip"},[e._v("生成前端api接口文件存放位置")])],1),i("FormItem",{attrs:{label:"生成router位置"}},[i("Input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.router,callback:function(t){e.$set(e.storage,"router",t)},expression:"storage.router"}}),i("div",{staticClass:"tip"},[e._v("生成前端路由存放位置")])],1)],1)],1)}),[],!1,null,"0c926c96",null).exports),i("46c4")),m=i("6987");s={name:"system_code_generation",components:{FoundationForm:s,StorageLoc:u,TableForm:d},data:function(){return{currentTab:0,headerList:[{label:"基础信息",value:"foundation"},{label:"字段配置",value:"table"},{label:"存放位置",value:"storage"}],formItem:{foundation:{pid:"",tableName:"",modelName:"",isTable:1,menuName:""},tableForm:{},storage:{},field:{},formItem:{}},ruleValidate:{foundation:{}},tableField:[],rowList:[],reqloading:!1,id:""}},created:function(){this.$route.query.id&&(this.id=this.$route.query.id,this.getDetail(this.$route.query.id))},mounted:function(){},methods:{getDetail:function(e){var t=this;Object(l.b)(e).then((function(e){e=e.data.crudInfo.field;var i=(t.formItem.foundation.pid=Number(e.pid),t.formItem.foundation.tableName=e.tableName,t.formItem.foundation.modelName=e.modelName,t.formItem.foundation.menuName=e.menuName,t.$refs.TableForm.tableField=e.tableField,t.formItem.storage=e.filePath,0);e.tableField.map((function(e){"create_time"!==e.field&&"update_time"!==e.field||2==++i&&(t.$refs.TableForm.isCreate=!0),"delete_time"===e.field&&(t.$refs.TableForm.isDelete=!0)}))}))},storageData:function(e){this.formItem.storage=e},beforeTab:function(){this.currentTab--},addRow:function(){var e=this,t=this.formItem.foundation;if(!t.tableName)return this.$Message.warning("请先填写表名");t={menuName:t.menuName,tableName:t.tableName,fromField:[],columnField:[]},Object(l.d)(t).then((function(t){e.$refs.TableForm.tableField=t.data.tableField.length?t.data.tableField:[],e.formItem.storage=t.data.makePath,t.data.tableField.length||e.$refs.TableForm.tableField.push({field:"id",field_type:"int",default:"",comment:"自增ID",required:!1,is_table:!0,table_name:"",limit:"10",primaryKey:1,from_type:"0"}),e.currentTab++})).catch((function(t){e.$Message.warning(t.msg)}))},nextTab:function(){var e,t=this;if(0==this.currentTab){if(!this.formItem.foundation.tableName)return this.$Message.warning("请输入表名");if(!this.formItem.foundation.modelName)return this.$Message.warning("请输入模块名");if(!this.formItem.foundation.isTable){if(!this.$refs.TableForm.tableField.length)return this.$Message.warning("请先添加表数据");if(this.$refs.TableForm.tableField.length)for(var i=0;i<this.$refs.TableForm.tableField.length;i++){var n=this.$refs.TableForm.tableField[i];if(!(-1!==["addSoftDelete","addTimestamps"].indexOf(n.field_type)||n.field&&n.field_type&&n.comment))return this.$Message.warning("请完善sql表数据")}}if(this.id)return this.currentTab++;this.addRow()}else 2==this.currentTab?this.reqloading||(e=Object(a.a)(Object(a.a)({},this.formItem.foundation),{},{filePath:this.formItem.storage,tableField:this.$refs.TableForm.tableField,deleteField:this.id?this.$refs.TableForm.deleteField:[]}),this.id?(e.id=this.id,this.$Modal.confirm({title:"生成提醒",content:'重新提交会重新生成文件,<span style="color: red">删除、新增、修改</span>的字段将直接从改表中进行修改,请慎重操作！！',loading:!0,onOk:function(){t.saveCodeCrud(e,!0)}})):this.$Modal.confirm({title:"生成提醒",content:"生成后本地开发调试会直接加载生成的vue页面；如果是上线后进行生成,可以进行浏览，代码生成列表中的修改文件将不生效。需要重新打包上线！",loading:!0,onOk:function(){t.saveCodeCrud(e,!0)}})):this.currentTab<3&&this.currentTab++},saveCodeCrud:function(e,t){var i=this;this.reqloading=!0,Object(n.i)(e).then((function(e){i.$Message.success(e.msg),i.getMenusUnique(),i.reqloading=!1,t&&i.$Modal.remove(),i.$router.push({name:"system_code_generation_list"})})).catch((function(e){i.reqloading=!1,i.$Message.error(e.msg)}))},getMenusUnique:function(){var e=this;Object(c.c)().then((function(t){t=t.data;var i=(e.$store.commit("userInfo/uniqueAuth",t.uniqueAuth),e.$store.commit("menus/getmenusNav",t.menus),e.$store.dispatch("routesList/setRoutesList",t.menus),Object(m.c)(e.$router.options.routes));e.formatTwoStageRoutes(i),i=Object(m.c)(t.menus);e.$store.commit("menus/setOneLvRoute",i),e.bus.$emit("routesListChange")}))},formatTwoStageRoutes:function(e){var t,i,n=this;return!(e.length<=0)&&(t=[],i=[],e.forEach((function(e){e&&e.meta&&e.meta.keepAlive&&(t.push(Object(a.a)({},e)),i.push(e.name),n.$store.dispatch("keepAliveNames/setCacheKeepAlive",i))})),t)}}},i("db90"),u=Object(o.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"code-wapper"},[i("div",{staticClass:"i-layout-page-header header-title"},[i("div",{staticClass:"fl_header"},[i("router-link",{attrs:{to:{path:e.$routeProStr+"/system/code_generation_list"}}},[i("Button",{attrs:{icon:"ios-arrow-back",size:"small",type:"text"}},[e._v("返回")])],1),i("Divider",{attrs:{type:"vertical"}}),i("span",{staticClass:"ivu-page-header-title mr20",staticStyle:{padding:"0"}},[e._v("添加功能")])],1)]),i("div",{staticClass:"message"},[i("Card",{attrs:{bordered:!1,"dis-hover":""}},[i("Steps",{attrs:{current:e.currentTab}},e._l(e.headerList,(function(e,t){return i("Step",{key:t,attrs:{title:e.label}})})),1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"0"==e.currentTab,expression:"currentTab == '0'"}],staticClass:"pt10 tab-1"},[i("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[i("FoundationForm",{ref:"Foundation",attrs:{foundation:e.formItem.foundation,tableField:e.tableField},on:{storageData:e.storageData}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.currentTab,expression:"currentTab == '1'"}],staticClass:"pt10"},[i("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[i("TableForm",{ref:"TableForm",attrs:{foundation:e.formItem.foundation,tableField:e.tableField,id:e.id},on:{storageData:e.storageData}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"==e.currentTab,expression:"currentTab == '2'"}],staticClass:"pt10"},[i("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[i("StorageLoc",{attrs:{storage:e.formItem.storage}})],1)],1),i("Card",{staticClass:"btn",attrs:{bordered:!1,"dis-hover":""}},[i("Button",{staticClass:"mr20",on:{click:e.beforeTab}},[e._v("上一步")]),i("Button",{attrs:{type:"primary"},on:{click:e.nextTab}},[e._v(e._s(2==e.currentTab?"提交":"下一步"))])],1)],1)}),[],!1,null,"65f20dd0",null);t.default=u.exports},db90:function(e,t,i){"use strict";var a=i("5003");i.n(a).a},ec36:function(e,t,i){}}]);