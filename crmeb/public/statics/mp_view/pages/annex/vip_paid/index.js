require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/annex/vip_paid/index"],{"4c1a":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("26cb"),o=n("8ba8"),r=n("666f"),s=(n("f984"),m(n("78e3"))),a=n("a9a5");function m(e){return e&&e.__esModule?e:{default:e}}var l=function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("03ff"))}.bind(null,n)).catch(n.oe)},u=function(){Promise.all([n.e("common/vendor"),n.e("components/payment/index")]).then(function(){return resolve(n("b647"))}.bind(null,n)).catch(n.oe)},c={components:{home:l,payment:u},filters:{dateFormat:function(e){return(0,s.default)(1e3*e).format("YYYY-MM-DD")},moneyFormat:function(e){return parseFloat(e)}},data:function(){return{memberType:[],userInfo:{},memberRights:[],memberExplain:[],memberCoupons:[],isGetFree:null,popupShow:!1,account:"",password:"",goodsList:[],pay_order_id:"",payMode:[{name:this.$t("微信支付"),icon:"icon-weixinzhifu",value:"weixin",title:this.$t("微信支付"),payStatus:!0}],pay_close:!1,totalPrice:"0",formContent:"",page:1,limit:15,finished:!1,memberEndTime:"",type:"",svip:null,mc_id:0,initIn:!1}},watch:{popupShow:{immediate:!0,handler:function(){this.account="",this.password=""}}},computed:(0,i.mapGetters)(["isLogin"]),onLoad:function(){this.isLogin?(this.memberCard(),this.groomList(),this.getOrderPayType()):(0,r.toLogin)()},onShow:function(){this.payClose();var e=wx.getEnterOptionsSync();if("1038"==e.scene&&"wxef277996acc166c3"==e.referrerInfo.appId&&this.initIn){var t=e.referrerInfo.extraData;this.initIn=!1,t?("success"==t.code||t.code,this.memberCard()):this.memberCard()}},onReachBottom:function(){this.groomList()},methods:{pay:function(){"free"===this.type?this.createMemberCard("weixin"):this.pay_close=!0},scrollToCard:function(){var t=e.createSelectorQuery().in(this);t.select("#card").boundingClientRect((function(t){e.pageScrollTo({scrollTop:t.top})})).exec()},goDetail:function(t){e.navigateTo({url:"/pages/goods_details/index?id=".concat(t)})},memberCard:function(){var t=this;e.showLoading({title:this.$t("正在加载中")}),(0,o.memberCard)().then((function(n){e.hideLoading();var i=n.data,r=i.is_get_free,s=i.member_coupons,a=i.member_explain,m=i.member_rights,l=i.member_type;t.isGetFree=r,t.userInfo=r.user_info,t.memberRights=m,t.memberType=l,t.memberCoupons=s,t.memberExplain=a,r.is_record&&(t.memberType=t.memberType.filter((function(e){return"free"!==e.type}))),t.totalPrice=t.memberType[0].pre_price,t.type=t.memberType[0].type,t.svip=t.memberType[0],t.mc_id=t.memberType[0].mc_id,(0,o.memberOverdueTime)({member_type:t.svip.type,vip_day:t.svip.vip_day}).then((function(e){t.memberEndTime=e.data.data}))})).catch((function(t){e.showToast({title:t,icon:"none"})}))},groomList:function(){var t=this;this.finished||(e.showLoading({title:this.$t("正在加载中")}),(0,o.groomList)(5,{page:this.page,limit:this.limit}).then((function(n){e.hideLoading(),t.goodsList=t.goodsList.concat(n.data.list),t.finished=n.data.list.length<t.limit,t.page+=1})).catch((function(t){e.hideLoading()})))},checkType:function(e){var t=this;this.type=e.type,this.svip=e,this.totalPrice=e.pre_price,this.mc_id=e.mc_id,(0,o.memberOverdueTime)({member_type:e.type,vip_day:e.vip_day,mc_id:e.mc_id}).then((function(e){t.memberEndTime=e.data.data}))},closePopup:function(){this.popupShow=!1},getMemberCard:function(){var e=this;(0,o.memberCard)().then((function(t){var n=t.data;e.memberType=n.member_type,e.memberRights=n.member_rights,e.isGetFree=n.is_get_free})).catch((function(e){}))},getOrderPayType:function(){var t=this;(0,a.basicConfig)().then((function(e){var n=e.data,i=(n.ali_pay_status,n.pay_weixin_open);t.payMode[0].payStatus=i,t.payMode[1].payStatus=!1})).catch((function(t){e.showToast({title:t,icon:"none"})}))},memberSelect:function(e){this.memberSelected=e},drawMemberCard:function(){var t={member_card_code:"",member_card_pwd:"",from:"weixinh5"};return this.popupShow?this.account?this.password?(t.from="routine",e.showLoading({title:this.$t("正在加载中")}),void(0,o.memberCardDraw)(t).then((function(t){e.showToast({title:t.msg,success:function(){this.popupShow=!1,this.getMemberCard()}})})).catch((function(t){e.showToast({title:t,icon:"none"})}))):e.showToast({title:this.$t("请输入卡密"),icon:"none"}):e.showToast({title:this.$t("请输入卡号"),icon:"none"}):this.popupShow=!0},createMemberCard:function(t){var n=this;e.showLoading({title:this.$t("正在加载中")});var i={pay_type:t,type:"1",from:"routine",member_type:this.svip.type,mc_id:this.mc_id,price:this.svip.pre_price,money:this.svip.price};(0,o.memberCardCreate)(i).then((function(t){parseFloat(n.svip.pre_price)>0?n.callPay(t):(n.memberCard(),n.groomList(),e.hideLoading(),e.showToast({title:n.$t("成功开启试用")}))})).catch((function(t){e.showToast({title:t,icon:"none"})}))},formpost:function(e,t){var n=document.createElement("form");for(var i in n.action=e,n.method="post",n.target="_self",n.style.display="none",t){var o=document.createElement("input");o.name=i,o.value=t[i],n.appendChild(o)}document.body.appendChild(n),this.$nextTick((function(e){n.submit()}))},callPay:function(t){var n=this,i=t.data,o=i.status,r=i.result,s=(r.orderId,r.jsConfig);switch(o){case"ORDER_EXIST":case"EXTEND_ORDER":case"ALLINPAY_PAY":e.hideLoading(),this.initIn=!0,wx.openEmbeddedMiniProgram({appId:"wxef277996acc166c3",extraData:{cusid:s.cusid,appid:s.appid,version:s.version,trxamt:s.trxamt,reqsn:s.reqsn,notify_url:s.notify_url,body:s.body,remark:s.remark,validtime:s.validtime,randomstr:s.randomstr,paytype:s.paytype,sign:s.sign,signtype:s.signtype}}),this.jumpData={orderId:t.data.result.orderId,msg:t.msg};break;case"PAY_ERROR":e.hideLoading(),this.$util.Tips({title:t.msg},{tab:5,url:"/pages/annex/vip_paid/index"});break;case"SUCCESS":e.hideLoading(),this.$util.Tips({title:t.msg,icon:"success"},{tab:5,url:"/pages/annex/vip_paid/index"});break;case"WECHAT_PAY":var a="";a=e.requestOrderPayment?"requestOrderPayment":"requestPayment",e[a]({timeStamp:s.timestamp,nonceStr:s.nonceStr,package:s.package,signType:s.signType,paySign:s.paySign,success:function(e){n.$util.Tips({title:n.$t("支付成功"),icon:"success"},{tab:5,url:"/pages/annex/vip_paid/index"})},fail:function(){e.showToast({title:n.$t("取消支付"),icon:"none"})},complete:function(){e.hideLoading()}});break;case"WECHAT_H5_PAY":e.showToast({title:t.msg,success:function(){location.href=s.h5_url}});break;case"ALIPAY_PAY":e.hideLoading(),e.navigateTo({url:"/pages/users/alipay_invoke/index?id=".concat(t.data.result.order_id,"&link=").concat(s.qrCode,"&from=member")});break}},onChangeFun:function(e){var t=e,n=t.action||null,i=void 0!=t.value?t.value:null;this.pay_close=!1,n&&this[n]&&this[n](i)},payClose:function(){this.pay_close=!1},payCheck:function(e){this.createMemberCard(e)},checkForm:function(t){var n=this,i=t.detail.value,r={member_card_code:"",member_card_pwd:"",from:"H5 "};return i.account?i.password?(r.member_card_code=i.account,r.member_card_pwd=i.password,r.from="routine",e.showLoading({title:this.$t("active")}),void(0,o.memberCardDraw)(r).then((function(t){var i=n;e.showToast({title:t.msg,success:function(){i.popupShow=!1}})})).catch((function(t){e.showToast({title:t,icon:"none"})}))):e.showToast({title:this.$t("请输入卡密"),icon:"none"}):e.showToast({title:this.$t("请输入卡号"),icon:"none"})}}};t.default=c}).call(this,n("543d")["default"])},"5f8d":function(e,t,n){"use strict";var i=n("ff8b"),o=n.n(i);o.a},"85b4":function(e,t,n){"use strict";n.r(t);var i=n("4c1a"),o=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},b885:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.userInfo.is_ever_level?e.$t("永久SVIP会员"):null),i=!e.userInfo.is_ever_level&&e.userInfo.is_money_level?e.$t("SVIP会员"):null,o=!e.userInfo.is_ever_level&&e.userInfo.is_money_level?e._f("dateFormat")(e.userInfo.overdue_time):null,r=!e.userInfo.is_ever_level&&e.userInfo.is_money_level?e.$t("到期"):null,s=e.userInfo.is_ever_level||e.userInfo.is_money_level?null:e.$t("您与"),a=e.userInfo.is_ever_level||e.userInfo.is_money_level?null:e.$t("商城的第"),m=e.userInfo.is_ever_level||e.userInfo.is_money_level?null:e.$t("天."),l=e.userInfo.is_money_level?e.$t("已累积为您节省"):null,u=e.userInfo.is_money_level?e.$t("￥"):null,c=e.userInfo.is_money_level?null:e.$t("开通即享会员权益"),p=!e.userInfo.is_ever_level&&e.userInfo.is_money_level?e.$t("续费会员"):null,d=e.userInfo.is_ever_level||e.userInfo.is_money_level?null:e.$t("开通会员"),f=e.$t("SVIP会员尊享权"),_=!e.userInfo.is_ever_level&&e.userInfo.is_money_level?e.$t("续费会员"):null,h=e.userInfo.is_ever_level||e.userInfo.is_money_level?null:e.$t("开通会员"),v=e.userInfo.is_ever_level?null:e.$t("有效期至"),y=e.$t("￥"),b=e.userInfo.is_ever_level?null:e.__map(e.memberType,(function(t,n){var i=e.__get_orig(t),o=e._f("moneyFormat")(t.pre_price),r="free"===t.type?e.$t("试用"):null,s="free"===t.type?e.$t("天"):null,a="free"!==t.type?e.$t("￥"):null,m="free"!==t.type?e._f("moneyFormat")(t.price):null;return{$orig:i,f1:o,m16:r,m17:s,m18:a,f2:m}})),g=!e.userInfo.is_ever_level&&e.memberExplain?e.$t("购买即视为同意"):null,$=!e.userInfo.is_ever_level&&e.memberExplain?e.$t("会员用户协议"):null,I=e.userInfo.is_ever_level||"free"!==e.type?null:e.$t("立即试用"),w=e.userInfo.is_ever_level||"free"===e.type?null:e.$t("立即支付"),T=e.userInfo.is_ever_level?null:e.$t("点击兑换卡密"),C=e.memberCoupons.length?e.$t("会员优惠券"):null,x=e.memberCoupons.length?e.$t("查看更多"):null,L=e.$t("￥"),P=e.memberCoupons.length?e.__map(e.memberCoupons,(function(t,n){var i=e.__get_orig(t),o=t.is_fail||t.status===e.$t("已使用"),r=e._f("moneyFormat")(t.coupon_price),s="0.00"===t.use_min_price?e.$t("无门槛券"):null,a="0.00"!==t.use_min_price?e.$t("满"):null,m="0.00"!==t.use_min_price?e._f("moneyFormat")(t.use_min_price):null,l="0.00"!==t.use_min_price?e.$t("元可用"):null;return{$orig:i,m26:o,f3:r,m28:s,m29:a,f4:m,m30:l}})):null,S=e.goodsList.length?e.$t("SVIP商品推荐"):null,E=e.$t("￥"),k=e.$t("商城价"),M=e.$t("￥"),F=e.$t("激活会员卡"),O=e.$t("请输入卡号"),R=e.$t("请输入卡密"),A=e.$t("确认激活");e.$mp.data=Object.assign({},{$root:{m0:n,m1:i,f0:o,m2:r,m3:s,m4:a,m5:m,m6:l,m7:u,m8:c,m9:p,m10:d,m11:f,m12:_,m13:h,m14:v,m15:y,l0:b,m19:g,m20:$,m21:I,m22:w,m23:T,m24:C,m25:x,m27:L,l1:P,m31:S,m32:E,m33:k,m34:M,m35:F,m36:O,m37:R,m38:A}})},r=[]},b981:function(e,t,n){"use strict";n.r(t);var i=n("b885"),o=n("85b4");for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("5f8d");var s,a=n("f0c5"),m=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"b5ab3532",null,!1,i["a"],s);t["default"]=m.exports},f9b4:function(e,t,n){"use strict";(function(e){n("248d");i(n("66fd"));var t=i(n("b981"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},ff8b:function(e,t,n){}},[["f9b4","common/runtime","common/vendor"]]]);