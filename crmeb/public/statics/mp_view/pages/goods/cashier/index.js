require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/cashier/index"],{"0aad":function(t,e,a){"use strict";a.r(e);var i=a("93e2"),r=a("cf1f");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("ef00");var s,o=a("f0c5"),c=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"b89fff52",null,!1,i["a"],s);e["default"]=c.exports},"17f3":function(t,e,a){"use strict";(function(t){a("248d");i(a("66fd"));var e=i(a("0aad"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(e.default)}).call(this,a("543d")["createPage"])},"93e2":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement,a=(t._self._c,t.payPriceShow?t.$t("￥"):null),i=t.payPriceShow?t.$t("支付剩余时间"):null,r=t.payPriceShow?t.$t("支付方式"):null,n=t.payPriceShow?t.__map(t.cartArr,(function(e,a){var i=t.__get_orig(e),r="yue"==e.value?t.$t("￥"):null;return{$orig:i,m3:r}})):null,s=t.payPriceShow?t.$t("确认支付"):null;t.$mp.data=Object.assign({},{$root:{m0:a,m1:i,m2:r,l0:n,m4:s}})},n=[]},a518:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("451d"),r=a("a9a5"),n=function(){a.e("components/countDown/index").then(function(){return resolve(a("46a1"))}.bind(null,a)).catch(a.oe)},s=function(){a.e("components/numberScroll").then(function(){return resolve(a("fd65"))}.bind(null,a)).catch(a.oe)},o={components:{countDown:n,numberScroll:s},data:function(){return{checked:!1,datatime:1676344056,cartArr:[{name:this.$t("微信支付"),icon:"icon-weixin2",value:"weixin",title:this.$t("使用微信快捷支付"),payStatus:1},{name:this.$t("支付宝支付"),icon:"icon-zhifubao",value:"alipay",title:this.$t("使用支付宝支付"),payStatus:1},{name:this.$t("余额支付"),icon:"icon-yuezhifu",value:"yue",title:this.$t("可用余额"),payStatus:1},{name:this.$t("线下支付"),icon:"icon-yuezhifu1",value:"offline",title:this.$t("使用线下付款"),payStatus:2},{name:this.$t("好友代付"),icon:"icon-haoyoudaizhifu",value:"friend",title:this.$t("找微信好友支付"),payStatus:1}],orderId:0,fromType:"",active:0,payPrice:0,payPriceShow:0,payPostage:0,offlinePostage:!1,invalidTime:0,initIn:!1,jumpData:{orderId:"",msg:""},formContent:""}},watch:{cartArr:{handler:function(t,e){var a=[];t.forEach((function(t,e){t.payStatus&&(t.index=e,a.push(t))})),this.active=a[0].index,this.paytype=a[0].value,this.number=a[0].number||0},immediate:!0,deep:!0}},onLoad:function(t){t.order_id&&(this.orderId=t.order_id),t.from_type&&(this.fromType=t.from_type),this.getBasicConfig()},onShow:function(){var e=wx.getEnterOptionsSync();if("1038"==e.scene&&"wxef277996acc166c3"==e.referrerInfo.appId&&this.initIn){var a=e.referrerInfo.extraData;this.initIn=!1,a?"success"==a.code?this.$util.Tips({title:this.$t("支付成功"),icon:"success"},{tab:5,url:"/pages/goods/order_pay_status/index?order_id=".concat(this.orderId,"&msg=").concat(this.jumpData.msg,"&type=3&totalPrice=").concat(this.payPriceShow)}):"cancel"==a.code?this.$util.Tips({title:this.$t("取消支付")},{tab:5,url:"/pages/goods/order_pay_status/index?order_id=".concat(this.orderId,"&msg=").concat(this.$t("取消支付"),"&type=3&totalPrice=").concat(this.payPriceShow,"&status=2")}):t.reLaunch({url:"/pages/goods/order_pay_status/index?order_id=".concat(this.orderId,"&msg=").concat(this.$t("支付失败"),"&totalPrice=").concat(this.payPriceShow)}):this.$util.Tips({title:this.$t("取消支付")},{tab:5,url:"/pages/goods/order_pay_status/index?order_id=".concat(this.orderId,"&msg=").concat(this.$t("取消支付"),"&type=3&totalPrice=").concat(this.payPriceShow,"&status=2")})}},methods:{getBasicConfig:function(){var e=this;(0,r.basicConfig)().then((function(t){e.cartArr[0].payStatus=t.data.wechat_pay_status||0,e.cartArr[1].payStatus=t.data.ali_pay_status||0,e.cartArr[1].payStatus=0,e.cartArr[2].payStatus=t.data.yue_pay_status,t.data.offline_pay_status?e.cartArr[3].payStatus=1:e.cartArr[3].payStatus=0,e.cartArr[4].payStatus=t.data.friend_pay_status||0,e.getCashierOrder()})).catch((function(a){return t.hideLoading(),e.$util.Tips({title:a})}))},getCashierOrder:function(){var e=this;t.showLoading({title:this.$t("创建订单中")}),(0,i.getCashierOrder)(this.orderId,this.fromType).then((function(a){e.payPrice=e.payPriceShow=a.data.pay_price,e.payPostage=a.data.pay_postage,e.offlinePostage=a.data.offline_postage,e.invalidTime=a.data.invalid_time,e.cartArr[2].number=a.data.now_money,t.hideLoading()})).catch((function(a){return t.hideLoading(),e.$util.Tips({title:a})}))},payType:function(t,e,a){this.active=a,this.paytype=e,this.number=t,this.offlinePostage&&(this.payPriceShow="offline"==e?this.$util.$h.Sub(this.payPrice,this.payPostage):this.payPrice)},formpost:function(t,e){var a=document.createElement("form");for(var i in a.action=t,a.method="post",a.target="_self",a.style.display="none",e){var r=document.createElement("input");r.name=i,r.value=e[i],a.appendChild(r)}document.body.appendChild(a),this.$nextTick((function(t){a.submit()}))},waitPay:function(){t.reLaunch({url:"/pages/goods/order_pay_status/index?order_id="+this.orderId+"&msg=取消支付&type=3&status=2&totalPrice="+this.payPriceShow})},goPay:function(e,a){var r=this,n=this;return n.orderId?"yue"==a&&parseFloat(e)<parseFloat(n.payPriceShow)?n.$util.Tips({title:n.$t("余额不足")}):(t.showLoading({title:n.$t("支付中")}),"friend"==a&&n.orderId?(t.hideLoading(),t.navigateTo({url:"/pages/users/payment_on_behalf/index?order_id="+n.orderId+"&spread="+this.$store.state.app.uid,success:function(t){},fail:function(){},complete:function(){}})):void(0,i.orderPay)({uni:n.orderId,paytype:a,type:n.friendPay?1:0}).then((function(e){var i=e.data.status,s=e.data.result.orderId,o=e.data.result.jsConfig,c="/pages/goods/order_pay_status/index?order_id="+r.orderId+"&msg="+e.msg+"&type=3&totalPrice="+r.payPriceShow,u="/pages/users/payment_on_behalf/index?order_id="+r.orderId+"&spread="+r.$store.state.app.uid;switch(i){case"ORDER_EXIST":case"EXTEND_ORDER":return t.hideLoading(),n.$util.Tips({title:e.msg},{tab:5,url:c});case"ALLINPAY_PAY":t.hideLoading(),r.initIn=!0,wx.openEmbeddedMiniProgram({appId:"wxef277996acc166c3",extraData:{cusid:o.cusid,appid:o.appid,version:o.version,trxamt:o.trxamt,reqsn:o.reqsn,notify_url:o.notify_url,body:o.body,remark:o.remark,validtime:o.validtime,randomstr:o.randomstr,paytype:o.paytype,sign:o.sign,signtype:o.signtype}}),r.jumpData={orderId:e.data.result.orderId,msg:e.msg};break;case"PAY_ERROR":return t.hideLoading(),n.$util.Tips({title:e.msg},{tab:5,url:c});case"SUCCESS":return t.hideLoading(),"friend"!==a?n.$util.Tips({title:e.msg,icon:"success"},{tab:4,url:c}):n.$util.Tips({title:e.msg,icon:"success"},{tab:4,url:u});case"WECHAT_PAY":n.toPay=!0;var d="";d=t.requestOrderPayment?"requestOrderPayment":"requestPayment",t[d]({timeStamp:o.timestamp,nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(e){return t.hideLoading(),n.BargainId||n.combinationId||n.pinkId||n.seckillId||n.discountId?n.$util.Tips({title:n.$t("支付成功"),icon:"success"},{tab:4,url:c}):n.$util.Tips({title:n.$t("支付成功"),icon:"success"},{tab:5,url:c})},fail:function(e){return t.hideLoading(),n.$util.Tips({title:n.$t("取消支付")},{tab:5,url:c+"&status=2"})},complete:function(a){if(t.hideLoading(),"requestPayment:cancel"==e.errMsg||"requestOrderPayment:cancel"==a.errMsg)return n.$util.Tips({title:n.$t("取消支付")},{tab:5,url:c+"&status=2"})}});break;case"PAY_DEFICIENCY":return t.hideLoading(),n.$util.Tips({title:e.msg},{tab:5,url:c+"&status=1"});case"WECHAT_H5_PAY":t.hideLoading(),n.$util.Tips({title:n.$t("等待支付中")},{tab:4,url:c+"&status=0"}),setTimeout((function(){location.href=e.data.result.jsConfig.h5_url}),1500);break;case"ALIPAY_PAY":t.navigateTo({url:"/pages/users/alipay_invoke/index?id=".concat(s,"&link=").concat(o.qrCode)});break}})).catch((function(e){return t.hideLoading(),n.$util.Tips({title:e},(function(){n.$emit("onChangeFun",{action:"pay_fail"})}))}))):n.$util.Tips({title:n.$t("请选择要支付的订单")})}}};e.default=o}).call(this,a("543d")["default"])},cf1f:function(t,e,a){"use strict";a.r(e);var i=a("a518"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},ef00:function(t,e,a){"use strict";var i=a("ff22"),r=a.n(i);r.a},ff22:function(t,e,a){}},[["17f3","common/runtime","common/vendor"]]]);