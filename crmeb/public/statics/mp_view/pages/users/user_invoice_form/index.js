require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_invoice_form/index"],{"03de":function(e,t,n){"use strict";(function(e){n("248d");i(n("66fd"));var t=i(n("1f0c"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"1f0c":function(e,t,n){"use strict";n.r(t);var i=n("43d6"),o=n("d0e6");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("2187");var r,s=n("f0c5"),c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"43dc1e61",null,!1,i["a"],r);t["default"]=c.exports},2187:function(e,t,n){"use strict";var i=n("7e25"),o=n.n(i);o.a},"43d6":function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.$t("抬头类型")),i=e.$t("个人"),o=e.$t("企业"),a=e.$t("发票类型"),r="2"===e.type&&"2"===e.header_type?e.$t("增值税电子专用发票"):null,s="2"!==e.type||"2"!==e.header_type?e.$t("增值税电子普通发票"):null,c=e.$t("发票抬头"),d="1"===e.header_type?e.$t("需要开具发票的姓名"):null,u="1"!==e.header_type?e.$t("需要开具发票的企业名称"):null,l=e.$t("税号"),f=e.$t("纳税人识别号"),h=e.$t("手机号"),m=e.$t("您的手机号"),p=e.$t("邮箱"),_=e.$t("您的联系邮箱"),$=e.$t("开户银行"),v=e.$t("您的开户银行"),w=e.$t("银行账号"),y=e.$t("您的银行账号"),T=e.$t("企业地址"),b=e.$t("您所在的企业地址"),g=e.$t("企业电话"),k=e.$t("您的企业电话"),I=e.$t("设置为默认抬头"),x=e.$t("保存"),N=e.$t("取消"),L=e.$t("发票类型选择"),Q=e.__map(e.invoiceTypeList,(function(t,n){var i=e.__get_orig(t),o="1"===t.value||"2"===t.value&&e.specialInvoice?e.$t(t.name):null,a="1"===t.value||"2"===t.value&&e.specialInvoice?e.$t(t.info):null;return{$orig:i,m27:o,m28:a}}));e.$mp.data=Object.assign({},{$root:{m0:n,m1:i,m2:o,m3:a,m4:r,m5:s,m6:c,m7:d,m8:u,m9:l,m10:f,m11:h,m12:m,m13:p,m14:_,m15:$,m16:v,m17:w,m18:y,m19:T,m20:b,m21:g,m22:k,m23:I,m24:x,m25:N,m26:L,l0:Q}})},a=[]},"65ba":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("8ba8"),o=a(n("66ca"));function a(e){return e&&e.__esModule?e:{default:e}}var r=function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("03ff"))}.bind(null,n)).catch(n.oe)},s={components:{home:r},mixins:[o.default],data:function(){return{invoiceTypeList:[{name:this.$t("增值税电子普通发票"),value:"1",info:this.$t("纸质发票开出后将以邮寄形式交付")},{name:this.$t("增值税电子专用发票"),value:"2",info:this.$t("纸质发票开出后将以邮寄形式交付")}],id:"",header_type:"1",type:"1",drawer_phone:"",name:"",duty_number:"",tell:"",address:"",bank:"",card_number:"",is_default:[],email:"",popupType:!1,typeName:"",urlQuery:"",from:"",specialInvoice:!0,order_id:""}},computed:{backUrl:function(){switch(this.from){case"order_confirm":return"/pages/goods/order_confirm/index".concat(this.urlQuery);default:return"/pages/users/user_invoice_list/index?from=invoice_form"}}},onHide:function(){this.from=""},onLoad:function(t){var n=this;for(var i in t.id&&e.setNavigationBarTitle({title:"编辑发票"}),t)switch(i){case"couponTitle":case"new":case"cartId":case"pinkId":case"couponId":case"addressId":this.urlQuery+="".concat(this.urlQuery?"&":"?").concat(i,"=").concat(t[i]);break;case"from":this.from=t[i];break;case"header_type":this.header_type=t[i];break;case"id":this.id=t[i],this.getInvoiceDetail();break;case"specialInvoice":"false"===t[i]&&(this.specialInvoice=!1);break}t.order_id&&(this.order_id=t.order_id);var o=this.invoiceTypeList.find((function(e){return e.value===n.type}));this.typeName=o.name},methods:{getInvoiceDetail:function(){var t=this;e.showLoading({title:this.$t("加载中")}),(0,i.invoiceDetail)(this.id).then((function(n){e.hideLoading(),t.header_type=n.data.header_type.toString(),t.type=n.data.type.toString();var i=t.invoiceTypeList.find((function(e){return e.value===t.type}));t.typeName=i.name,t.name=n.data.name,t.drawer_phone=n.data.drawer_phone,t.email=n.data.email,t.duty_number=n.data.duty_number,t.bank=n.data.bank,t.card_number=n.data.card_number,t.address=n.data.address,t.tell=n.data.tell,t.is_default=n.data.is_default?[""]:[]})).catch((function(t){e.showToast({title:t,icon:"none"})}))},formSubmit:function(t){var n=this,o=t.detail.value;if(o.type=this.type,"1"===o.header_type){if(!o.name)return e.showToast({title:n.$t("请输入需要开具发票的姓名"),icon:"none"});if(!o.drawer_phone)return e.showToast({title:n.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(o.drawer_phone))return e.showToast({title:n.$t("请正确输入您的手机号"),icon:"none"});if(!o.email)return e.showToast({title:n.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:n.$t("请正确输入您的联系邮箱"),icon:"none"})}if("2"===o.header_type){if("1"===o.type){if(!o.name)return e.showToast({title:n.$t("请输入需要开具发票的企业名称"),icon:"none"});if(!o.duty_number)return e.showToast({title:n.$t("请输入纳税人识别号"),icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(o.duty_number))return e.showToast({title:n.$t("请正确输入纳税人识别号"),icon:"none"});if(!o.drawer_phone)return e.showToast({title:n.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(o.drawer_phone))return e.showToast({title:n.$t("请正确输入您的手机号"),icon:"none"});if(!o.email)return e.showToast({title:n.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:n.$t("请正确输入您的联系邮箱"),icon:"none"})}if("2"===o.type){if(!o.name)return e.showToast({title:n.$t("请输入需要开具发票的企业名称"),icon:"none"});if(!o.duty_number)return e.showToast({title:n.$t("请输入纳税人识别号"),icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(o.duty_number))return e.showToast({title:n.$t("请正确输入纳税人识别号"),icon:"none"});if(!o.drawer_phone)return e.showToast({title:n.$t("请输入您的手机号"),icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(o.drawer_phone))return e.showToast({title:n.$t("请正确输入您的手机号"),icon:"none"});if(!o.email)return e.showToast({title:n.$t("请输入您的联系邮箱"),icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(o.email))return e.showToast({title:n.$t("请正确输入您的联系邮箱"),icon:"none"});if(!o.bank)return e.showToast({title:n.$t("请输入您的开户银行"),icon:"none"});if(!o.card_number)return e.showToast({title:n.$t("请输入您的银行账号"),icon:"none"});if(!/^\d{16}|\d{19}$/.test(o.card_number))return e.showToast({title:n.$t("请正确输入您的银行账号"),icon:"none"});if(!o.address)return e.showToast({title:n.$t("请输入您所在的企业地址"),icon:"none"});if(!o.tell)return e.showToast({title:n.$t("请输入您的企业电话"),icon:"none"})}}o.is_default=o.is_default.length,o.id=this.id,e.showLoading({title:n.$t("保存中")}),(0,i.invoiceSave)(o).then((function(t){e.showToast({title:t.msg,icon:"success"}),setTimeout((function(i){switch(n.from){case"order_confirm":n.id?e.navigateTo({url:"/pages/goods/order_confirm/index".concat(n.urlQuery,"&invoice_id=").concat(n.id,"&invoice_type=").concat(o.type)}):e.navigateTo({url:"/pages/goods/order_confirm/index".concat(n.urlQuery,"&invoice_id=").concat(t.data.id,"&invoice_type=").concat(o.type)});break;case"order_details":n.id?e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(n.order_id,"&invoice_id=").concat(n.id)}):e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(n.order_id,"&invoice_id=").concat(t.data.id)});break;default:e.navigateTo({url:"/pages/users/user_invoice_list/index?from=invoice_form"});break}}),1e3)})).catch((function(t){e.showToast({title:t,icon:"none"})}))},callType:function(){2==this.header_type?this.popupType=!0:e.showToast({title:this.$t("个人仅支持普通发票"),icon:"none"})},changeType:function(e){var t=e.detail.value,n=this.invoiceTypeList.find((function(e){return e.value===t}));"2"===t&&"1"===this.header_type&&(this.header_type="2"),this.typeName=n.name,this.type=t,this.popupType=!1},closeType:function(){this.popupType=!1},changeTitleType:function(e){this.header_type=e.detail.value,this.type="1"}}};t.default=s}).call(this,n("543d")["default"])},"7e25":function(e,t,n){},d0e6:function(e,t,n){"use strict";n.r(t);var i=n("65ba"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a}},[["03de","common/runtime","common/vendor"]]]);